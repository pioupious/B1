# Backup et Snapshot

**Restauration Windows:** c'est un sauvegarde du **systeme** cela impact uniquement les logiciels, drivers ... installée aveant le point de restauration. Tout **fichier** supprimés restera suprimé.

**Snapshot :** Uniquement présent sur les VMs, il prend en compte l'os et les fichier sur le VM conservé.

**Sauvegarde  :** une sauvegarde donne les mêmes résultat que les snapshots mais restaure toute la machine pour en créer une nouvelle ou pas (sous condition de compatibilité matérielle)

**Sauvegarde bar Metal  :** on sevegarde une machine réel 

------------------------------------------

**Full Clone (Clone Complet)**
· **Description :** C’est une copie indépendante et complète d’une machine virtuelle.
· **Stockage :** Copie tous les fichiers de disque de la VM source.
· **Performances :** Performances comparables à une VM normale.
· **Indépendance :** La VM clonée n’a plus aucun lien avec la VM d’origine.
· **Utilisation :** Idéal pour le déploiement à long terme, en production ou pour transférer vers un autre
hôte.

**Clone Lié (Linked Clone)**
· **Description :** C’est une copie partielle d’une VM, qui dépend du disque de la VM d’origine.
· **Stockage :** Seul un delta (différentiel) est créé ; les données de base sont lues sur le disque de la
VM source.
· **Performances :** Moins bonnes que le full clone, surtout si le disque source est très sollicité.
· **Indépendance :** La VM clonée est dépendante de la VM source.
· **Utilisation :** Idéal pour des tests, des environnements temporaires, ou le développement.

| Caractéristique          | Full Clone               | Clone Lié               |
|-------------------------|--------------------------|-------------------------|
| **Taille sur disque**   | Grande (copie complète)  | Petite (différentielle) |
| **Indépendance**        | Oui                      | Non                     |
| **Performances**        | Meilleures               | Moins bonnes            |
| **Utilisation typique** | Production, long terme   | Tests, développement     |
| **Dépendance disque**   | Aucune                   | Oui (besoin du disque source) |


--------------------------------------------------
**Sysrep**

Le Sysprep (System Preparation Tool) est un outil Windows utilisé pour préparer une image système à la
duplication, au déploiement ou au transfert vers un autre ordinateur. Il est surtout utilisé dans des environnements
où plusieurs machines doivent être installées à partir d'une même image de base.

```
cd C:\Windows\System32\Sysprep
sysprep.exe /generalize /oobe /shutdown /mode:vm
```

 **Quand Faut-il Faire un Sysprep ?**

Il existe plusieurs situations typiques où l'exécution de Sysprep est nécessaire :

1. **Avant de créer une image système à cloner**
   - **Objectif** : Empêcher que plusieurs machines aient le même identifiant système (SID).
   - **Pourquoi** : Des SID identiques peuvent poser problème dans un domaine Active Directory (AD), avec certains logiciels, ou pour la gestion réseau.
   - **Exemple** : Tu veux créer une image de Windows que tu vas déployer sur 50 PC — tu dois Sysprep la machine avant de la capturer.

2. **Avant de créer un clone destiné à être utilisé comme machine indépendante**
   - **Full Clone** : Recommandé si la VM est destinée à être utilisée comme un poste distinct, notamment si elle va rejoindre un domaine ou recevoir une licence différente.
   - **Linked Clone** : Pas nécessaire si tu restes dans un contexte de test ou de développement et que les machines ne sont pas destinées à vivre indépendamment.

3. **Avant de distribuer un PC avec Windows préinstallé (OEM/entreprise)**
   - Les fabricants de PC utilisent Sysprep pour préparer Windows en mode OOBE (Out-of-Box Experience), afin que l'utilisateur final configure la langue, le compte, etc.

**Résumé : Quand utiliser Sysprep ?**

| Situation                                      | Faut-il utiliser Sysprep ? | Pourquoi                                       |
|------------------------------------------------|-----------------------------|-----------------------------------------------|
| Création d’une image à déployer sur plusieurs machines | Oui                         | Pour générer un SID unique sur chaque PC      |
| Clonage pour tests temporaires                 | Non                         | Pas indispensable, sauf si tu veux simuler un vrai poste |
| Déploiement en entreprise / OEM                | Oui                         | Pour forcer l’OOBE et la personnalisation utilisateur |
| Clonage d’une VM pour un environnement de production | Oui                         | Pour éviter les conflits réseau et SID        |

**Attention**

- **Après Sysprep**, certaines personnalisations sont réinitialisées :
  - Nom de l'ordinateur
  - Comptes utilisateur locaux
  - Configuration réseau

- **Limitation d'utilisation** : Sysprep ne peut être exécuté qu’un nombre limité de fois sur une même installation Windows (généralement 8 ou 9 fois max).

-----------------------
